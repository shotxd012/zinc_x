<% if (locals.modalPrefix) { %>
<div
  id="<%= modalPrefix %>-embed-preview"
  tabindex="-1"
  aria-hidden="true"
  class="fixed left-0 right-0 top-0 z-50 hidden h-[calc(100%-1rem)] max-h-full w-full items-center justify-center overflow-y-auto overflow-x-hidden md:inset-0">
  <div class="relative max-h-full w-full max-w-screen-xl p-4">
    <!-- Modal Header -->
    <div
      class="flex items-center justify-between rounded-t border-b border-gray-200 bg-white p-3 md:p-4 dark:border-gray-600 dark:bg-gray-700">
      <h3 class="text-xl font-medium text-gray-900 dark:text-white"><%= tr("EMBED_PREVIEW.HEADER") %></h3>
      <button
        type="button"
        class="ms-auto inline-flex h-8 w-8 items-center justify-center rounded-lg bg-transparent text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900 dark:hover:bg-gray-600 dark:hover:text-white"
        data-modal-hide="<%= modalPrefix %>-embed-preview">
        <svg class="h-3 w-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
          <path
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
        </svg>
        <span class="sr-only"><%= tr("EMBED_PREVIEW.CLOSE_BTN") %></span>
      </button>
    </div>

    <!-- Modal Content -->
    <% } %>
    <div
      class="grid grid-cols-1 gap-0 overflow-hidden rounded-lg border border-gray-200 lg:grid-cols-2 dark:border-gray-700">
      <!-- START: Col 1 (Configuration) -->
      <div class="bg-white p-6 dark:bg-gray-800">
        <!-- Plain Text -->
        <div class="mb-3">
          <div class="mb-2">
            <label class="text-sm font-semibold text-gray-900 dark:text-white"
              ><%= tr("EMBED_PREVIEW.CONTENT") %></label
            >
          </div>
          <textarea
            x-model="<%= locals.content %>"
            rows="3"
            class="mt-1 block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
            placeholder="<%= locals.placeholder %>"></textarea>
        </div>

        <!-- Embed Options -->
        <div>
          <h4 class="mb-2 text-sm font-semibold text-gray-900 dark:text-white"><%= tr("EMBED_PREVIEW.OPTIONS") %></h4>
          <!-- Title -->
          <div class="mb-3">
            <div class="mb-2">
              <label class="text-xs font-semibold text-gray-900 dark:text-white"
                ><%= tr("EMBED_PREVIEW.TITLE") %></label
              >
            </div>
            <input
              x-model="<%= locals.embed?.title %>"
              type="text"
              maxlength="256"
              class="block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
              placeholder="Welcome to our server!" />
          </div>
          <!-- Description -->
          <div class="mb-3">
            <div class="mb-2">
              <label class="text-xs font-semibold text-gray-900 dark:text-white"
                ><%= tr("EMBED_PREVIEW.DESCRIPTION") %></label
              >
            </div>
            <textarea
              x-model="<%= locals.embed?.description %>"
              rows="3"
              maxlength="4096"
              class="block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
              placeholder="We're excited to have you here!"></textarea>
          </div>
          <!-- Color -->
          <div class="mb-3">
            <div class="mb-2">
              <label class="text-xs font-semibold text-gray-900 dark:text-white"
                ><%= tr("EMBED_PREVIEW.COLOR") %></label
              >
            </div>
            <div class="flex items-center gap-3">
              <input
                x-model="<%= locals.embed?.color %>"
                type="color"
                class="h-8 w-12 cursor-pointer rounded border-0 p-0"
                style="background: none" />
              <span class="text-xs text-gray-500 dark:text-gray-400" x-text="<%= locals.embed?.color %>"></span>
            </div>
          </div>
          <!-- Author & Icon -->
          <div class="mb-3 grid grid-cols-1 gap-4 md:grid-cols-2">
            <div>
              <div class="mb-2">
                <label class="text-xs font-semibold text-gray-900 dark:text-white"
                  ><%= tr("EMBED_PREVIEW.AUTHOR_NAME") %></label
                >
              </div>
              <input
                x-model="<%= locals.embed?.author.name %>"
                type="text"
                maxlength="256"
                class="block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
                placeholder="" />
            </div>
            <div>
              <div class="mb-2">
                <label class="text-xs font-semibold text-gray-900 dark:text-white"
                  ><%= tr("EMBED_PREVIEW.AUTHOR_ICON") %></label
                >
              </div>
              <input
                x-model="<%= locals.embed?.author.iconURL %>"
                type="url"
                class="block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
                placeholder="<%= tr(`EMBED_PREVIEW.URL_PLACEHOLDER`) %>" />
            </div>
          </div>
          <!-- Fields -->
          <div class="mb-3">
            <div class="mb-2">
              <label class="text-xs font-semibold text-gray-900 dark:text-white"
                ><%= tr("EMBED_PREVIEW.FIELDS") %></label
              >
            </div>
            <template x-for="(field, idx) in <%= locals.embed?.fields %>" :key="idx">
              <div class="mb-2 flex min-w-0 items-center gap-2">
                <!-- Field Name -->
                <input
                  x-model="field.name"
                  type="text"
                  maxlength="256"
                  class="flex-1 rounded border border-gray-300 bg-gray-50 p-2 text-sm text-gray-900 transition focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
                  placeholder="<%= tr(`EMBED_PREVIEW.FIELD_NAME`) %>"
                  aria-label="Field Name" />

                <!-- Field Value -->
                <input
                  x-model="field.value"
                  type="text"
                  maxlength="1024"
                  class="flex-1 rounded border border-gray-300 bg-gray-50 p-2 text-sm text-gray-900 transition focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
                  placeholder="<%= tr(`EMBED_PREVIEW.FIELD_VALUE`) %>"
                  aria-label="Field Value" />

                <!-- Inline Checkbox -->
                <label class="flex items-center gap-1 whitespace-nowrap px-2 text-xs">
                  <input
                    type="checkbox"
                    x-model="field.inline"
                    class="rounded border-gray-300 bg-gray-50 focus:ring-indigo-500 dark:bg-gray-700"
                    aria-label="<%= tr('EMBED_PREVIEW.FIELD_INLINE') %>" />
                  <span class="text-gray-700 dark:text-gray-300"><%= tr("EMBED_PREVIEW.FIELD_INLINE") %></span>
                </label>
                <button
                  type="button"
                  @click="removeField(idx)"
                  class="flex h-8 w-8 items-center justify-center rounded-full text-gray-400 transition-colors duration-150 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 dark:hover:text-red-400"
                  aria-label="<%= tr('EMBED_PREVIEW.REMOVE_FIELD') %>"
                  title="<%= tr('EMBED_PREVIEW.REMOVE_FIELD') %>">
                  <i class="fa-solid fa-xmark fa-lg"></i>
                </button>
              </div>
            </template>
            <button type="button" @click="addField()" class="mt-1 rounded bg-[#5865F2] px-3 py-1 text-xs text-white">
              + <%= tr("EMBED_PREVIEW.ADD_FIELD") %>
            </button>
          </div>
          <!-- Footer & Icon -->
          <div class="mb-3 grid grid-cols-1 gap-4 md:grid-cols-2">
            <div>
              <div class="mb-2">
                <label class="text-xs font-semibold text-gray-900 dark:text-white"
                  ><%= tr("EMBED_PREVIEW.FOOTER_TEXT") %></label
                >
              </div>
              <input
                x-model="<%= locals.embed?.footer.text %>"
                type="text"
                maxlength="2048"
                class="block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
                placeholder="" />
            </div>
            <div>
              <div class="mb-2">
                <label class="text-xs font-semibold text-gray-900 dark:text-white"
                  ><%= tr("EMBED_PREVIEW.FOOTER_ICON") %></label
                >
              </div>
              <input
                x-model="<%= locals.embed?.footer.iconURL %>"
                type="url"
                class="block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
                placeholder="<%= tr(`EMBED_PREVIEW.URL_PLACEHOLDER`) %>" />
            </div>
          </div>
          <!-- Thumbnail & Image -->
          <div class="mb-3 grid grid-cols-1 gap-4 md:grid-cols-2">
            <div>
              <div class="mb-2">
                <label class="text-xs font-semibold text-gray-900 dark:text-white"
                  ><%= tr("EMBED_PREVIEW.THUMBNAIL") %></label
                >
              </div>
              <input
                x-model="<%= locals.embed?.thumbnail %>"
                type="url"
                class="block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
                placeholder="<%= tr(`EMBED_PREVIEW.URL_PLACEHOLDER`) %>" />
            </div>
            <div>
              <div class="mb-2">
                <label class="text-xs font-semibold text-gray-900 dark:text-white"
                  ><%= tr("EMBED_PREVIEW.IMAGE") %></label
                >
              </div>
              <input
                x-model="<%= locals.embed?.image %>"
                type="url"
                class="block w-full rounded border border-gray-300 bg-gray-50 p-2 text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
                placeholder="<%= tr(`EMBED_PREVIEW.URL_PLACEHOLDER`) %>" />
            </div>
          </div>
          <!-- Timestamp -->
          <div class="mb-3 flex items-center gap-2">
            <input
              type="checkbox"
              x-model="<%= locals.embed?.timestamp %>"
              class="rounded border-gray-300 bg-gray-50 dark:bg-gray-700" />
            <label class="text-xs font-semibold text-gray-900 dark:text-white"
              ><%= tr("EMBED_PREVIEW.TIMESTAMP") %></label
            >
          </div>
        </div>
      </div>
      <!-- END: Col 1 (Configuration) -->

      <!-- START: Col 2 (Preview) -->
      <div class="border-l border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-900">
        <div class="rounded-lg bg-[#36393F] p-4">
          <!-- Channel & Time -->
          <div class="mb-2 flex items-center text-xs text-[#99AAb5]">
            <span class="mr-1 font-bold">#</span>
            <span x-text="<%= channelName %>"></span>
            <span class="mx-2">•</span>
            <% const now = new Date(); %>
            <span
              x-text="new Date(<%= now.getTime() %>).toLocaleTimeString([], {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
              })">
            </span>
          </div>
          <!-- Bot Message -->
          <div class="mb-3 flex">
            <img
              class="mr-3 h-10 w-10 rounded-full"
              src="<%= coreConfig['DASHBOARD']['LOGO_URL'] %>"
              alt="Bot Avatar" />
            <div>
              <div class="font-bold text-white"><%= coreConfig['DASHBOARD']['LOGO_NAME'] %></div>
              <div class="whitespace-pre-wrap text-[#dcddde]" x-text="<%= content %>"></div>
            </div>
          </div>
          <!-- Embed -->
          <template
            x-if="<%= locals.embed?.title %> || <%= locals.embed?.description %> || <%= locals.embed?.fields %>.length > 0">
            <div
              class="mb-4 rounded border-l-4 p-4"
              :style="`background:#2f3136;border-color:${<%= locals.embed?.color %> || '#5865F2'}`">
              <!-- Author -->
              <template x-if="<%= locals.embed?.author.name %>">
                <div class="mb-2 flex items-center">
                  <template x-if="<%= locals.embed?.author.iconURL %>">
                    <img :src="<%= locals.embed?.author.iconURL %>" class="mr-2 h-6 w-6 rounded-full" />
                  </template>
                  <span class="font-bold text-white" x-text="<%= locals.embed?.author.name %>"></span>
                </div>
              </template>
              <!-- Title -->
              <template x-if="<%= locals.embed?.title %>">
                <div class="mb-2 text-lg font-bold text-white" x-text="<%= locals.embed?.title %>"></div>
              </template>
              <!-- Description -->
              <template x-if="<%= locals.embed?.description %>">
                <div class="mb-3 whitespace-pre-wrap text-[#dcddde]" x-text="<%= locals.embed?.description %>"></div>
              </template>
              <!-- Thumbnail -->
              <template x-if="<%= locals.embed?.thumbnail %>">
                <div class="float-right mb-2 ml-4">
                  <img :src="<%= locals.embed?.thumbnail %>" class="h-16 w-16 rounded-lg" />
                </div>
              </template>
              <!-- Fields -->
              <template x-if="<%= locals.embed?.fields %>.length > 0">
                <div class="mb-3 grid grid-cols-1 gap-4 md:grid-cols-2">
                  <template x-for="field in <%= locals.embed?.fields %>">
                    <div class="mb-2" :class="field.inline ? 'inline-block w-full' : 'col-span-2'">
                      <div class="font-bold text-white" x-text="field.name || 'Field title'"></div>
                      <div class="whitespace-pre-wrap text-[#dcddde]" x-text="field.value || 'Field content'"></div>
                    </div>
                  </template>
                </div>
              </template>
              <!-- Image -->
              <template x-if="<%= locals.embed?.image %>">
                <img :src="<%= locals.embed?.image %>" class="mt-2 max-h-60 w-full rounded-lg object-cover" />
              </template>
              <!-- Footer -->
              <template x-if="<%= locals.embed?.footer.text || embed.timestamp %>">
                <div class="mt-3 flex items-center text-xs text-[#99AAb5]">
                  <template x-if="<%= locals.embed?.footer.iconURL %>">
                    <img :src="<%= locals.embed?.footer.iconURL %>" class="mr-1 h-4 w-4 rounded-full" />
                  </template>
                  <span x-text="<%= locals.embed?.footer.text %>"></span>
                  <template x-if="<%= locals.embed?.footer.text && embed.timestamp %>">
                    <span class="mx-1">•</span>
                  </template>
                  <span x-show="<%= locals.embed?.timestamp %>" x-text="new Date().toLocaleString()"></span>
                </div>
              </template>
            </div>
          </template>
          <!-- Empty State -->
          <template
            x-if="!<%= locals.embed?.title %> && !<%= locals.embed?.description %> && <%= locals.embed?.fields %>.length === 0">
            <div class="py-8 text-center text-[#99AAb5]"><%= tr("EMBED_PREVIEW.PREVIEW_PLACEHOLDER") %></div>
          </template>
        </div>
      </div>
      <!-- END: Col 2 (Preview) -->
    </div>
    <% if (locals.modalPrefix) { %>
  </div>
</div>
<% } %>
